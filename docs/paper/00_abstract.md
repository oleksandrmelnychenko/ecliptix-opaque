# Гібридний постквантовий протокол автентифікації на основі парольного ключового обміну OPAQUE з інтеграцією ML-KEM-768

---

## АНОТАЦІЯ

Парольна автентифікація залишається домінуючим механізмом підтвердження особи користувачів у сучасних інформаційних системах. Криптографічну основу найбільш безпечних протоколів парольного автентифікованого ключового обміну (PAKE), зокрема протоколу OPAQUE, складають операції на еліптичних кривих та протокол Діффі--Геллмана, безпека яких базується на складності задачі дискретного логарифмування. Поява масштабованих квантових комп'ютерів, здатних ефективно реалізувати алгоритм Шора, створює фундаментальну загрозу для цих криптографічних примітивів, а відтак -- для всієї інфраструктури парольної автентифікації, побудованої на їх основі. Стратегія "збирай зараз, дешифруй пізніше" (harvest now, decrypt later) робить цю загрозу актуальною вже сьогодні, оскільки перехоплені сеанси автентифікації можуть бути розшифровані ретроспективно з появою достатньо потужного квантового обчислювача.

Метою даного дослідження є розробка гібридного постквантового розширення протоколу OPAQUE, що забезпечує одночасну стійкість як до класичних, так і до квантових криптоаналітичних атак. Запропоновано конструкцію Hybrid PQ-OPAQUE, в якій механізм інкапсуляції ключів ML-KEM-768 (FIPS 203) інтегровано в потік автентифікованого ключового обміну 3DH як обов'язкову, а не опціональну складову протоколу. Класичний ключовий матеріал від трьох операцій Діффі--Геллмана на кривій Ristretto255 (96 байт) конкатенується зі спільним секретом ML-KEM-768 (32 байт), після чого об'єднаний вхід (128 байт) обробляється функцією HKDF-Extract на основі HMAC-SHA-512 із контекстно-залежною сіллю, що містить мічений хеш транскрипту всіх публічних елементів обміну, включаючи постквантовий відкритий ключ та шифротекст. Отриманий псевдовипадковий ключ використовується для деривації сеансових ключів, майстер-ключа та ключів MAC через HKDF-Expand з унікальними доменними розділювачами.

Показано, що запропонована конструкція зберігає всі фундаментальні властивості безпеки протоколу OPAQUE: секретність паролю (пароль не розкривається навіть при компрометації сервера), пряму секретність (forward secrecy), взаємну автентифікацію сторін та стійкість до офлайн-атак перебору за словником. Водночас протокол набуває стійкості до квантових атак за моделлю "AND" -- для успішного зламу противнику необхідно подолати одночасно і класичну, і постквантову складові. Формальна верифікація протоколу виконана у системах Tamarin Prover (7 лем, включаючи секретність сеансового ключа, forward secrecy та AND-model security) та ProVerif (3 запити безпеки), що підтвердила коректність ключових властивостей захисту. Емпірична верифікація включає 22 тести властивостей безпеки (session key independence, transcript binding, KEM contribution, replay resistance) та детерміновані тестові вектори у форматі JSON для незалежної валідації.

Протокол зберігає кількість повідомлень (три) та кількість раундів (1,5 RTT) класичного OPAQUE, а додатковий overhead складає 2272 байти (+516% до класичного OPAQUE), що повністю зумовлено розмірами відкритого ключа (1184 байти) та шифротексту (1088 байт) ML-KEM-768. Експериментальна оцінка на платформі Apple M1 Pro (10 ядер, 16 ГБ RAM, AppleClang 17, Release -O3) демонструє, що постквантовий компонент ML-KEM-768 є обчислювально ефективнішим за класичний обмін Діффі--Геллмана на Ristretto255 (повний раунд KEM: 55.3 мкс проти одиничного скалярного множення DH: 43.7 мкс), гібридний комбінатор додає лише 5.8 мкс обчислювальних витрат, серверна пропускна здатність становить ~3010 операцій генерації KE2 на секунду, а загальна латентність автентифікації складає 586 мс, з яких 99.8% припадає на функцію розтягування паролю Argon2id.

**Ключові слова:** OPAQUE, парольний автентифікований ключовий обмін (PAKE), ML-KEM-768, постквантова криптографія, гібридний ключовий обмін, Ristretto255, HKDF, механізм інкапсуляції ключів, квантова стійкість, формальна верифікація, Tamarin Prover.
