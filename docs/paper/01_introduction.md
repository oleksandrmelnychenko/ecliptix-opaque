
---

## 1. ВСТУП

### 1.1. Актуальність проблеми

Парольна автентифікація залишається найбільш поширеним механізмом підтвердження особи в сучасних розподілених інформаційних системах. За різними оцінками, понад 80% процедур автентифікації у веб-додатках та мережевих сервісах базуються на паролях [1, 2]. Незважаючи на активний розвиток альтернативних підходів -- біометричної автентифікації, апаратних токенів стандарту FIDO2, автентифікації на основі сертифікатів -- паролі зберігають домінуючу позицію завдяки простоті розгортання, відсутності потреби у спеціалізованому обладнанні та звичності для кінцевих користувачів. Ця реальність визначає критичну важливість криптографічно коректних протоколів парольної автентифікації для безпеки глобальної цифрової інфраструктури.

Протоколи парольного автентифікованого ключового обміну (Password-Authenticated Key Exchange, PAKE) забезпечують встановлення захищеного каналу зв'язку між двома сторонами, які поділяють спільний секрет низької ентропії -- пароль -- без розкриття цього паролю пасивному чи активному противнику [3]. Серед існуючих протоколів PAKE протокол OPAQUE, запропонований Jarecki, Krawczyk та Xu у 2018 році [4], вважається найбільш безпечним представником класу асиметричних (augmented) PAKE. На відміну від збалансованих протоколів, де обидві сторони зберігають пароль, в асиметричному PAKE сервер зберігає лише криптографічний запис (registration record), з якого неможливо відновити пароль навіть при повній компрометації серверного сховища. OPAQUE досягає цієї властивості завдяки використанню обливіусної псевдовипадкової функції (Oblivious Pseudorandom Function, OPRF) [5], яка дозволяє серверу брати участь в обчисленні криптографічного ключа на основі паролю, не отримуючи при цьому жодної інформації про сам пароль. Протокол OPAQUE перебуває на етапі стандартизації в рамках IETF CFRG [6].

Криптографічна безпека протоколу OPAQUE, як і переважної більшості сучасних протоколів PAKE, фундаментально залежить від обчислювальної складності задачі дискретного логарифмування (Discrete Logarithm Problem, DLP) та її варіанту на еліптичних кривих (Elliptic Curve Discrete Logarithm Problem, ECDLP). Ключовий обмін 3DH (triple Diffie-Hellman), що становить основу протоколу OPAQUE, виконує три операції скалярного множення на еліптичній кривій, безпека кожної з яких безпосередньо базується на складності ECDLP. Аналогічно, протокол SRP (Secure Remote Password) [7] базується на задачі DLP у мультиплікативній групі цілих чисел, а протокол SPAKE2 [8] -- на ECDLP.

### 1.2. Квантова загроза

У 1994 році Пітер Шор запропонував квантовий алгоритм [9], здатний розв'язувати задачу факторизації цілих чисел та задачу дискретного логарифмування за поліноміальний час на квантовому комп'ютері. Алгоритм Шора безпосередньо загрожує всім криптосистемам, безпека яких базується на цих задачах: RSA, протоколу Діффі--Геллмана, криптографії на еліптичних кривих (ECDH, ECDSA) [10]. Зокрема, для зламу криптографії на еліптичних кривих з рівнем безпеки 128 біт алгоритму Шора достатньо квантового комп'ютера з приблизно 2330 логічними кубітами [11]. Хоча сучасні квантові комп'ютери ще не досягли необхідного масштабу, темпи розвитку квантових технологій та значні інвестиції з боку державних та приватних структур свідчать про те, що криптографічно релевантні квантові комп'ютери (Cryptographically Relevant Quantum Computers, CRQC) можуть з'явитися протягом найближчих 10--20 років [12].

Особливу загрозу становить стратегія "збирай зараз, дешифруй пізніше" (Harvest Now, Decrypt Later, HNDL), за якої противник перехоплює та зберігає зашифрований трафік сьогодні з метою його дешифрування на квантовому комп'ютері в майбутньому [13]. У контексті парольної автентифікації ця загроза означає, що перехоплені повідомлення протоколу ключового обміну можуть бути ретроспективно проаналізовані для відновлення сеансових ключів, а потенційно -- і самих паролів. Для систем, що обробляють довготривалі конфіденційні дані (медичні записи, фінансова інформація, державна таємниця), загроза HNDL є актуальною вже сьогодні, що обумовлює необхідність превентивного переходу до постквантово стійких криптографічних протоколів.

### 1.3. Стандартизація постквантової криптографії

Усвідомлюючи масштаб квантової загрози, Національний інститут стандартів і технологій США (NIST) у 2016 році ініціював процес стандартизації постквантових криптографічних алгоритмів [14]. Після кількох раундів оцінювання, у серпні 2024 року NIST опублікував перші стандарти постквантової криптографії: FIPS 203 (ML-KEM -- Module-Lattice-Based Key-Encapsulation Mechanism) [15] та FIPS 204 (ML-DSA -- Module-Lattice-Based Digital Signature Algorithm) [16]. Стандарт ML-KEM, що базується на алгоритмі CRYSTALS-Kyber [17], визначає три набори параметрів: ML-KEM-512 (рівень безпеки NIST 1), ML-KEM-768 (рівень безпеки NIST 3) та ML-KEM-1024 (рівень безпеки NIST 5). Безпека ML-KEM базується на обчислювальній складності задачі навчання з помилками на модульних решітках (Module Learning With Errors, Module-LWE), для якої не відомо ефективних квантових алгоритмів розв'язання [17].

Паралельно з процесом стандартизації окремих примітивів, індустрія розпочала інтеграцію постквантових механізмів у існуючі протоколи. Гібридні підходи, що комбінують класичну та постквантову криптографію, впроваджуються в TLS 1.3 [18], протокол Signal (PQXDH) [19] та WireGuard [20]. Ключовою перевагою гібридного підходу є забезпечення безпеки за моделлю "AND": для зламу системи противнику необхідно подолати одночасно обидві криптографічні складові, що дозволяє зберегти захист навіть у разі виявлення вразливості в одній з них [21].

### 1.4. Обмеження існуючих рішень

Аналіз сучасного стану постквантової парольної автентифікації виявляє значну прогалину між потребами та наявними рішеннями.

По-перше, класичний протокол OPAQUE у його поточній специфікації IETF [6] не містить жодних механізмів захисту від квантових атак. Ключовий обмін 3DH виконується виключно на еліптичних кривих, і весь ключовий матеріал, з якого виводяться сеансові ключі, може бути відновлений противником, що володіє квантовим комп'ютером, здатним розв'язувати задачу ECDLP.

По-друге, інші широко використовувані протоколи парольної автентифікації -- SRP [7] та SPAKE2 [8] -- є так само вразливими до квантових атак, оскільки їхня безпека базується відповідно на задачі DLP у мультиплікативних групах та ECDLP. Більше того, ці протоколи не забезпечують рівня безпеки OPAQUE: SRP не має формального доведення безпеки в моделі UC-security [22], а SPAKE2 є збалансованим PAKE, що не забезпечує захисту від компрометації сервера.

По-третє, чисто постквантові протоколи PAKE перебувають на ранній стадії дослідження та не досягли достатнього рівня зрілості для практичного застосування. Існуючі пропозиції PQ-PAKE здебільшого базуються на решітковій криптографії, проте стикаються з проблемами ефективності, відсутності формальних доведень безпеки та недостатньою дослідженістю у реальних умовах розгортання [23]. Відсутність класичного криптографічного "запасного варіанту" (fallback) у чисто постквантових конструкціях створює ризик повної втрати безпеки у разі виявлення вразливості в базовій постквантовій задачі -- ризик, який не є гіпотетичним, враховуючи відносну молодість решіткових криптосистем порівняно з десятиліттями криптоаналізу класичних схем.

По-четверте, існуючі гібридні рішення, впроваджені в TLS 1.3, Signal та WireGuard, вирішують проблему постквантового захисту ключового обміну, проте жодне з них не адресує специфіку парольної автентифікації: вони не використовують OPRF для приховування паролю, не забезпечують захист від компрометації серверного сховища та не реалізують модель асиметричного PAKE. У відкритій науковій літературі на момент проведення дослідження відсутні стандартизовані чи формально проаналізовані гібридні постквантові розширення протоколу OPAQUE, що становить відкриту дослідницьку проблему, на вирішення якої спрямоване дане дослідження.

### 1.5. Мета та завдання дослідження

Метою даного дослідження є розробка, реалізація та аналіз гібридної постквантової конструкції на основі протоколу OPAQUE, що забезпечує одночасну стійкість до класичних та квантових криптоаналітичних атак без втрати існуючих властивостей безпеки базового протоколу.

Для досягнення зазначеної мети поставлено такі завдання:

1) здійснити аналіз існуючих протоколів парольного автентифікованого ключового обміну та гібридних постквантових рішень з метою ідентифікації прогалин та можливостей розширення;

2) розробити конструкцію гібридного комбінатора ключового матеріалу, що інтегрує механізм інкапсуляції ключів ML-KEM-768 у потік автентифікованого ключового обміну 3DH протоколу OPAQUE;

3) визначити механізм розширеного транскрипту, що включає постквантові елементи (відкритий ключ KEM та шифротекст) для забезпечення цілісності та зв'язування всіх криптографічних контекстів;

4) провести аналіз безпеки запропонованої конструкції щодо збереження фундаментальних властивостей протоколу OPAQUE та набуття постквантової стійкості;

5) виконати формальну верифікацію протоколу у системах Tamarin Prover та ProVerif для машинно-перевірюваного підтвердження ключових властивостей безпеки;

6) реалізувати запропонований протокол у вигляді кросплатформної бібліотеки та провести систематичну оцінку продуктивності з мікробенчмарками окремих криптопримітивів, макробенчмарками фаз протоколу та вимірюванням серверної пропускної здатності.

### 1.6. Наукова новизна та внесок

Основний науковий внесок даної роботи полягає в наступному:

1. **Гібридна конструкція PQ-OPAQUE.** Вперше запропоновано та реалізовано гібридну схему розширення протоколу OPAQUE, в якій механізм інкапсуляції ключів ML-KEM-768 є обов'язковою, а не опціональною складовою протоколу. На відміну від більшості існуючих гібридних підходів (TLS 1.3 hybrid, Signal PQXDH), де постквантова складова додається як додатковий шар, у запропонованій конструкції ML-KEM-768 є невід'ємною частиною потоку автентифікованого ключового обміну.

2. **Специфічний комбінатор ключового матеріалу.** Розроблено конструкцію комбінування класичного та постквантового ключового матеріалу через функцію HKDF-Extract (на основі HMAC-SHA-512) з контекстно-залежною сіллю, що містить мічений хеш транскрипту. Вхідний ключовий матеріал формується як конкатенація результатів трьох операцій Діффі--Геллмана (96 байт: dh1||dh2||dh3) та спільного секрету ML-KEM-768 (32 байт).

3. **Розширений транскрипт з постквантовими елементами.** Запропоновано включення відкритого ключа ML-KEM (kem_public_key, 1184 байти) та шифротексту (kem_ciphertext, 1088 байт) у транскрипт протоколу, що обчислюється як вхід для MAC-автентифікації обох сторін.

4. **Збереження всіх властивостей безпеки OPAQUE.** Показано, що запропонована гібридна конструкція зберігає секретність паролю, пряму секретність (forward secrecy), взаємну автентифікацію та стійкість до офлайн-атак перебору за словником, одночасно додаючи стійкість до квантових атак за моделлю "AND".

5. **Формальна верифікація та емпірична валідація.** Виконано формальну верифікацію протоколу у двох незалежних системах автоматичного доведення — Tamarin Prover (7 лем, включаючи AND-model security та forward secrecy) та ProVerif (3 запити безпеки). Розроблено набір з 22 автоматизованих тестів властивостей безпеки на рівні реалізації (session key independence, transcript binding, KEM contribution, replay resistance, cross-server isolation) та детерміновані тестові вектори у форматі JSON для незалежної валідації. Проведено систематичну оцінку продуктивності з мікробенчмарками окремих криптопримітивів (2000 ітерацій), макробенчмарками фаз протоколу (500 ітерацій) та вимірюванням серверної пропускної здатності.

### 1.7. Структура статті

Стаття організована таким чином. У розділі 2 наведено аналіз літературних джерел та існуючих рішень. Розділ 3 присвячено формальній постановці задачі. У розділі 4, що становить основну частину роботи, детально описано запропонований протокол Hybrid PQ-OPAQUE. Розділ 5 містить аналіз безпеки, включаючи формальну верифікацію у Tamarin Prover та ProVerif та емпіричну верифікацію властивостей безпеки. У розділі 6 описано реалізацію та наведено результати систематичної експериментальної оцінки продуктивності. Розділ 7 містить обговорення результатів. Висновки подано у розділі 8.
